<h2>Search Reservations</h2>

<div class="filters">
  <input placeholder="Reservation ID" [(ngModel)]="criteria.reservationId">
  <input placeholder="Passenger Name" [(ngModel)]="criteria.passengerName">
  <input placeholder="Train Number" [(ngModel)]="criteria.trainNumber">

  <select [(ngModel)]="criteria.status">
    <option value="">All Status</option>
    <option>Confirmed</option>
    <option>Pending</option>
    <option>Cancelled</option>
  </select>

  <input type="date" [(ngModel)]="criteria.reservationDate">

  <button (click)="search()">Search</button>
</div>

<table class="table" *ngIf="results.length">
  <thead>
    <tr>
      <th>Reservation ID</th>
      <th>Passenger Name</th>
      <th>Train No</th>
      <th>Reservation Date</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let r of paginatedResults">
      <td>{{ r.reservationId }}</td>
      <td>{{ r.passengerName }}</td>
      <td>
        <a href="#" (click)="viewTrainDetails(r); $event.preventDefault()">
          {{ r.trainNumber }}
        </a>
      </td>
      <td>{{ formatDate(r.reservationDate) }}</td>
      <td>{{ r.status }}</td>
      <td>
        <button (click)="edit(r)" [disabled]="r.status === 'Cancelled'">
          Edit
        </button>
        <button (click)="cancel(r.reservationId)" [disabled]="r.status === 'Cancelled'">
          Cancel
        </button>
      </td>
    </tr>
  </tbody>
</table>

<div class="pagination" *ngIf="results.length">
  <button (click)="prev()">Previous</button>
  <span>Page {{ page }}</span>
  <button (click)="next()">Next</button>
</div>

<div *ngIf="selected" class="detail">
  <h3>Train Details</h3>
  <p><b>Train:</b> {{ selected.trainName }} ({{ selected.trainNumber }})</p>
  <p><b>Route:</b> {{ selected.source }} → {{ selected.destination }}</p>
  <p>
    <b>Journey:</b><br>
    {{ selected.departureDay }} – {{ selected.departureTime }} (start)<br>
    {{ selected.arrivalDay }} – {{ selected.arrivalTime }} (end)
  </p>
  <p><b>Total Distance:</b> {{ selected.totalKms }} km</p>
</div>
